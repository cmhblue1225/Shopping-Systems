
# 입고요청서 시스템 분석 보고서

## 1. 프로젝트 개요

본 시스템은 웹 기반의 입고요청서 작성 애플리케이션입니다. 사용자는 웹 양식에 입고 관련 데이터를 입력하고, 입력된 내용을 기반으로 Excel 파일을 생성하거나 직접 인쇄할 수 있습니다. 또한, 작성한 내용을 브라우저의 로컬 스토리지를 사용하여 저장하고 불러오는 기능을 제공합니다.

**주요 기능:**
- 웹 기반 입고요청서 폼 제공
- 품목별 수량, 단가에 따른 금액 및 합계 자동 계산
- 동적으로 참조부서 추가 기능
- jSignature 라이브러리를 이용한 전자 서명 기능 (요청자, 검토자, 승인자)
- 작성 내용 Excel 파일(.xlsx)로 다운로드
- 작성 내용 인쇄용 양식으로 출력
- 여러 버전의 입고요청서를 이름 지정하여 저장 및 불러오기/삭제 기능

## 2. 파일 구조 분석

- **`index.html`**: 메인 페이지. 입고요청서의 전체적인 HTML 구조와 폼 요소를 포함합니다.
- **`assets/css/styles.css`**: 애플리케이션의 전반적인 스타일을 정의하는 CSS 파일입니다.
- **`assets/js/main.js`**: 애플리케이션의 핵심 로직을 담고 있는 JavaScript 파일입니다. 모든 동적 기능(계산, 저장, 엑셀 생성 등)이 여기에 구현되어 있습니다.
- **`assets/js/libs/`**: 외부 라이브러리 파일들이 위치합니다.
    - `jquery-3.6.0.min.js`: DOM 조작 및 이벤트 처리를 위한 jQuery.
    - `jSignature.min.js`: 전자 서명 패드 기능을 제공합니다.
    - `exceljs.min.js`: JavaScript 환경에서 Excel 파일을 생성하고 조작하는 라이브러리입니다.
    - `FileSaver.min.js`: 생성된 파일을 클라이언트 측에서 저장할 수 있게 해주는 유틸리티입니다.
- **`templates/form-template.html`**: `index.html`과 거의 동일한 내용의 폼 템플릿입니다. 초기 개발 단계의 유산이거나 특정 상황에서 동적으로 폼을 로드하기 위한 목적으로 보입니다.
- **`config/`, `data/`, `docs/`**: 각각 설정, 샘플 데이터, 문서 파일을 포함할 수 있는 디렉터리입니다. 현재 기능에 직접적인 영향을 주지는 않습니다.

## 3. 핵심 기능 분석

### 가. 데이터 입력 및 계산
- `index.html`에 정의된 폼을 통해 요청일, 요청자, 품목 정보 등을 입력받습니다.
- `main.js`의 `calcRow` 함수는 품목의 `수량`과 `단가` 입력 시 자동으로 `금액`과 전체 `합계`를 계산하여 폼에 반영합니다.

### 나. 데이터 저장 및 불러오기
- **다중 저장/불러오기**: `saveData`, `loadSavedData` 등의 함수를 통해 여러 개의 입고요청서 데이터를 `localStorage`에 '입고요청서_저장목록'이라는 키 값으로 저장합니다. 각 데이터는 사용자가 지정한 이름으로 구별되어 저장되고, 목록에서 선택하여 불러오거나 삭제할 수 있습니다.
- **임시 저장 (기존 방식)**: `saveToLocalStorage` 함수는 현재 폼 내용을 '입고요청서_임시저장'이라는 단일 키로 `localStorage`에 저장합니다. `downloadExcel` 또는 `printDocument` 함수 실행 시 자동으로 호출되어 작업 내용을 보존합니다.

### 다. 인쇄 기능
- `printDocument` 함수는 현재 폼 데이터를 기반으로 인쇄에 최적화된 새로운 HTML 문서를 동적으로 생성합니다.
- 이 HTML 문서는 A4 가로 방향 레이아웃에 맞춰 스타일이 지정되어 있으며, 서명 이미지를 포함합니다.
- `window.open`을 통해 새 창에서 문서를 열고 브라우저의 인쇄 대화상자를 호출합니다.

## 4. 엑셀 다운로드 양식 상세 분석

엑셀 다운로드 기능은 `main.js`의 `downloadExcel` 함수에 의해 처리되며, **ExcelJS** 라이브러리를 사용하여 동적으로 `.xlsx` 파일을 생성합니다.

### 가. 엑셀 파일의 기본 구조
- **시트 이름**: '입고요청서'
- **전체 레이아웃**: 11개 열(A~K)과 24개 행으로 구성된 고정된 양식입니다.

### 나. 셀 내용 및 데이터 매핑
- **제목 (A1:K2)**: '입고요청서' 텍스트가 병합된 셀에 표시됩니다.
- **기본 정보 (3~6행)**:
    - `요청일자`, `요청번호`, `요청자`, `입고예정일`이 각각 지정된 셀에 매핑됩니다.
    - `참조부서`는 여러 개 입력 시 쉼표(`, `)로 연결된 하나의 문자열로 C6 셀에 병합되어 들어갑니다.
- **품목 리스트 (8~18행)**:
    - 8행은 헤더(`순번`, `품명`, `규격`, `단위`, `수량`, `단가`, `금액`, `거래처`, `카테고리`, `입고 창고`, `비고`)입니다.
    - 9행부터 18행까지 10개의 품목 데이터가 순서대로 채워집니다.
- **합계 (19행)**: `합계`라는 텍스트와 함께 계산된 총액이 G19 셀에 들어갑니다.
- **비고 (20행)**: 폼의 '비고'란 내용이 B20 셀에 병합되어 들어갑니다.
- **거래처 정보 (23행)**: `거래처 담당자`, `연락처`, `이메일` 정보가 각각 지정된 셀에 들어갑니다.
- **서명란 (24행)**:
    - `요청자 서명`, `검토자 서명`, `승인자 서명` 텍스트가 표시됩니다.
    - **jSignature 패드에서 생성된 서명 이미지가 Base64로 인코딩되어 엑셀 파일 내에 이미지로 삽입됩니다.**
        - 요청자 서명: B23 셀 근처 (좌표: 1.1, 22.2)
        - 검토자 서명: D23 셀 근처 (좌표: 3.1, 22.2)
        - 승인자 서명: F23 셀 근처 (좌표: 5.1, 22.2)

### 다. 스타일 및 서식
- **폰트**: 제목은 '맑은 고딕', 16pt, 굵게 적용됩니다. 헤더 행(8행)과 서명란(15행-코드상 주석오류, 실제로는 24행)은 굵게 처리됩니다.
- **정렬**: 모든 셀의 내용은 가로 및 세로 중앙 정렬됩니다.
- **테두리**: A1부터 K24까지의 모든 셀에 얇은 실선 테두리가 적용됩니다.
- **셀 병합**: 제목, 기본 정보, 비고 등 여러 셀이 병합되어 깔끔한 양식을 구성합니다.
- **열 너비**: 모든 열의 너비는 16으로 고정됩니다.
