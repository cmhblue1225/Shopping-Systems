<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µí•© ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: monospace;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        .log {
            height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ Shopping Systems í†µí•© ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h3>ğŸ—ï¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testSystemInitialization()">ì‹œìŠ¤í…œ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸</button>
            <div id="init-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ’¾ ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testDataManager()">ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸</button>
            <div id="data-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ”„ ì‹¤ì‹œê°„ ë™ê¸°í™” í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testRealtimeSync()">ë™ê¸°í™” í…ŒìŠ¤íŠ¸</button>
            <div id="sync-results"></div>
        </div>

        <div class="test-section">
            <h3>âš¡ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testWorkflow()">ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸</button>
            <div id="workflow-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ” ê²€ìƒ‰ ì—”ì§„ í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testSearchEngine()">ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</button>
            <div id="search-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š í†µí•© API í…ŒìŠ¤íŠ¸</h3>
            <button onclick="testIntegratedAPI()">API í…ŒìŠ¤íŠ¸</button>
            <div id="api-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸš€ ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸</h3>
            <button onclick="runFullIntegrationTest()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="full-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“ í…ŒìŠ¤íŠ¸ ë¡œê·¸</h3>
            <button onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
            <div id="test-log" class="log"></div>
        </div>
    </div>

    <!-- í†µí•© ì‹œìŠ¤í…œ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="../core/data-manager.js"></script>
    <script src="../core/api-interface.js"></script>
    <script src="../core/realtime-sync.js"></script>
    <script src="../core/workflow-engine.js"></script>
    <script src="../core/search-engine.js"></script>

    <script>
        let testResults = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logElement = document.getElementById('test-log');
            logElement.innerHTML += `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            
            testResults.push({ timestamp, type, message });
        }

        function displayResult(containerId, result, message) {
            const container = document.getElementById(containerId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${result ? 'success' : 'error'}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function clearResults(containerId) {
            document.getElementById(containerId).innerHTML = '';
        }

        function clearLog() {
            document.getElementById('test-log').innerHTML = '';
            testResults = [];
        }

        // ì‹œìŠ¤í…œ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
        async function testSystemInitialization() {
            clearResults('init-results');
            log('ì‹œìŠ¤í…œ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸ ì‹œì‘');

            try {
                // ì „ì—­ ê°ì²´ ì¡´ì¬ í™•ì¸
                const components = [
                    { name: 'IntegratedDataManager', obj: window.IntegratedDataManager },
                    { name: 'IntegratedAPI', obj: window.IntegratedAPI },
                    { name: 'RealtimeSyncManager', obj: window.RealtimeSyncManager },
                    { name: 'WorkflowEngine', obj: window.WorkflowEngine },
                    { name: 'IntegratedSearchEngine', obj: window.IntegratedSearchEngine }
                ];

                for (const component of components) {
                    if (component.obj) {
                        displayResult('init-results', true, `âœ… ${component.name} ì´ˆê¸°í™” ì„±ê³µ`);
                        log(`${component.name} ì´ˆê¸°í™” í™•ì¸ë¨`);
                    } else {
                        displayResult('init-results', false, `âŒ ${component.name} ì´ˆê¸°í™” ì‹¤íŒ¨`);
                        log(`${component.name} ì´ˆê¸°í™” ì‹¤íŒ¨`, 'error');
                    }
                }

                // ê¸°ë³¸ í•¨ìˆ˜ ì¡´ì¬ í™•ì¸
                const functions = [
                    'getIntegratedData',
                    'setIntegratedData',
                    'subscribeToData',
                    'searchIntegrated',
                    'generateReport'
                ];

                for (const funcName of functions) {
                    if (typeof window[funcName] === 'function') {
                        displayResult('init-results', true, `âœ… ${funcName} í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥`);
                        log(`${funcName} í•¨ìˆ˜ í™•ì¸ë¨`);
                    } else {
                        displayResult('init-results', false, `âŒ ${funcName} í•¨ìˆ˜ ì—†ìŒ`);
                        log(`${funcName} í•¨ìˆ˜ ì—†ìŒ`, 'error');
                    }
                }

            } catch (error) {
                displayResult('init-results', false, `âŒ ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
                log(`ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸
        async function testDataManager() {
            clearResults('data-results');
            log('ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸ ì‹œì‘');

            try {
                const dataManager = window.IntegratedDataManager;
                
                // í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
                const testData = {
                    id: 'test_' + Date.now(),
                    name: 'í…ŒìŠ¤íŠ¸ í•­ëª©',
                    createdAt: new Date().toISOString()
                };

                // ë°ì´í„° ì €ì¥ í…ŒìŠ¤íŠ¸
                const success = dataManager.setData('test_items', [testData]);
                if (success) {
                    displayResult('data-results', true, 'âœ… ë°ì´í„° ì €ì¥ ì„±ê³µ');
                    log('ë°ì´í„° ì €ì¥ í…ŒìŠ¤íŠ¸ í†µê³¼');
                } else {
                    displayResult('data-results', false, 'âŒ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨');
                    log('ë°ì´í„° ì €ì¥ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                }

                // ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸
                const retrievedData = dataManager.getData('test_items');
                if (retrievedData && retrievedData.length > 0) {
                    displayResult('data-results', true, 'âœ… ë°ì´í„° ì¡°íšŒ ì„±ê³µ');
                    log('ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸ í†µê³¼');
                } else {
                    displayResult('data-results', false, 'âŒ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨');
                    log('ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                }

                // ë°ì´í„° ì¶”ê°€ í…ŒìŠ¤íŠ¸
                const addedItem = dataManager.addData('test_items', {
                    name: 'ì¶”ê°€ëœ í…ŒìŠ¤íŠ¸ í•­ëª©'
                });
                if (addedItem && addedItem.id) {
                    displayResult('data-results', true, 'âœ… ë°ì´í„° ì¶”ê°€ ì„±ê³µ');
                    log('ë°ì´í„° ì¶”ê°€ í…ŒìŠ¤íŠ¸ í†µê³¼');
                } else {
                    displayResult('data-results', false, 'âŒ ë°ì´í„° ì¶”ê°€ ì‹¤íŒ¨');
                    log('ë°ì´í„° ì¶”ê°€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                }

                // ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
                const systemStatus = dataManager.getSystemStatus();
                if (systemStatus && systemStatus.isHealthy) {
                    displayResult('data-results', true, 'âœ… ì‹œìŠ¤í…œ ìƒíƒœ ì •ìƒ');
                    log('ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ ì™„ë£Œ');
                } else {
                    displayResult('data-results', false, 'âŒ ì‹œìŠ¤í…œ ìƒíƒœ ì´ìƒ');
                    log('ì‹œìŠ¤í…œ ìƒíƒœ ì´ìƒ', 'error');
                }

            } catch (error) {
                displayResult('data-results', false, `âŒ ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
                log(`ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ì‹¤ì‹œê°„ ë™ê¸°í™” í…ŒìŠ¤íŠ¸
        async function testRealtimeSync() {
            clearResults('sync-results');
            log('ì‹¤ì‹œê°„ ë™ê¸°í™” í…ŒìŠ¤íŠ¸ ì‹œì‘');

            try {
                const syncManager = window.RealtimeSyncManager;
                const dataManager = window.IntegratedDataManager;

                // ì˜µì €ë²„ ë“±ë¡ í…ŒìŠ¤íŠ¸
                let syncDetected = false;
                const unsubscribe = dataManager.subscribe('test_sync', (event) => {
                    syncDetected = true;
                    log(`ë™ê¸°í™” ì´ë²¤íŠ¸ ê°ì§€: ${event.action}`);
                });

                // ë°ì´í„° ë³€ê²½ìœ¼ë¡œ ë™ê¸°í™” íŠ¸ë¦¬ê±°
                dataManager.setData('test_sync', [{ 
                    id: 'sync_test',
                    data: 'sync test data',
                    timestamp: new Date().toISOString()
                }]);

                // ì ì‹œ ëŒ€ê¸° í›„ í™•ì¸
                setTimeout(() => {
                    if (syncDetected) {
                        displayResult('sync-results', true, 'âœ… ì‹¤ì‹œê°„ ë™ê¸°í™” ê°ì§€ ì„±ê³µ');
                        log('ì‹¤ì‹œê°„ ë™ê¸°í™” í…ŒìŠ¤íŠ¸ í†µê³¼');
                    } else {
                        displayResult('sync-results', false, 'âŒ ì‹¤ì‹œê°„ ë™ê¸°í™” ê°ì§€ ì‹¤íŒ¨');
                        log('ì‹¤ì‹œê°„ ë™ê¸°í™” í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                    }
                    unsubscribe();
                }, 100);

                // ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸
                const isOnline = navigator.onLine;
                displayResult('sync-results', isOnline, 
                    isOnline ? 'âœ… ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ì˜¨ë¼ì¸' : 'âš ï¸ ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ì˜¤í”„ë¼ì¸');
                log(`ë„¤íŠ¸ì›Œí¬ ìƒíƒœ: ${isOnline ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸'}`);

            } catch (error) {
                displayResult('sync-results', false, `âŒ ë™ê¸°í™” í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
                log(`ë™ê¸°í™” í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸
        async function testWorkflow() {
            clearResults('workflow-results');
            log('ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì‹œì‘');

            try {
                const workflowEngine = window.WorkflowEngine;

                // ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ í™•ì¸
                const templates = workflowEngine.workflowTemplates;
                if (templates && templates.size > 0) {
                    displayResult('workflow-results', true, `âœ… ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ ë¡œë“œë¨ (${templates.size}ê°œ)`);
                    log(`ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ ${templates.size}ê°œ í™•ì¸`);
                } else {
                    displayResult('workflow-results', false, 'âŒ ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ ì—†ìŒ');
                    log('ì›Œí¬í”Œë¡œìš° í…œí”Œë¦¿ ì—†ìŒ', 'error');
                }

                // í…ŒìŠ¤íŠ¸ ì›Œí¬í”Œë¡œìš° ì‹œì‘
                const testEvent = {
                    type: 'data_change',
                    dataKey: 'newItemRegistrations',
                    action: 'add',
                    data: {
                        id: 'test_registration',
                        items: [{ itemCode: 'TEST001', itemName: 'í…ŒìŠ¤íŠ¸ í’ˆëª©' }]
                    }
                };

                workflowEngine.eventQueue.push(testEvent);
                workflowEngine.processEventQueue();

                // í™œì„± ì›Œí¬í”Œë¡œìš° í™•ì¸
                setTimeout(() => {
                    const activeWorkflows = workflowEngine.getActiveWorkflows();
                    if (activeWorkflows.length > 0) {
                        displayResult('workflow-results', true, `âœ… ì›Œí¬í”Œë¡œìš° ì‹œì‘ë¨ (${activeWorkflows.length}ê°œ í™œì„±)`);
                        log(`í™œì„± ì›Œí¬í”Œë¡œìš° ${activeWorkflows.length}ê°œ í™•ì¸`);
                    } else {
                        displayResult('workflow-results', false, 'âŒ ì›Œí¬í”Œë¡œìš° ì‹œì‘ ì‹¤íŒ¨');
                        log('ì›Œí¬í”Œë¡œìš° ì‹œì‘ ì‹¤íŒ¨', 'error');
                    }
                }, 100);

            } catch (error) {
                displayResult('workflow-results', false, `âŒ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
                log(`ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ê²€ìƒ‰ ì—”ì§„ í…ŒìŠ¤íŠ¸
        async function testSearchEngine() {
            clearResults('search-results');
            log('ê²€ìƒ‰ ì—”ì§„ í…ŒìŠ¤íŠ¸ ì‹œì‘');

            try {
                const searchEngine = window.IntegratedSearchEngine;

                // í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
                const testItems = [
                    { id: '1', itemName: 'ë…¸íŠ¸ë¶', category: 'ì „ìì œí’ˆ' },
                    { id: '2', itemName: 'ë§ˆìš°ìŠ¤', category: 'ì „ìì œí’ˆ' },
                    { id: '3', itemName: 'í‚¤ë³´ë“œ', category: 'ì „ìì œí’ˆ' }
                ];
                window.IntegratedDataManager.setData('items', testItems);

                // ì¸ë±ìŠ¤ ì¬êµ¬ì¶•
                searchEngine.buildIndex('items');

                // ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
                const searchResults = await searchEngine.search('ë…¸íŠ¸ë¶');
                if (searchResults && searchResults.results.length > 0) {
                    displayResult('search-results', true, `âœ… ê²€ìƒ‰ ì„±ê³µ (${searchResults.results.length}ê°œ ê²°ê³¼)`);
                    log(`ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ í†µê³¼: ${searchResults.results.length}ê°œ ê²°ê³¼`);
                } else {
                    displayResult('search-results', false, 'âŒ ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ');
                    log('ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                }

                // ë³´ê³ ì„œ í…œí”Œë¦¿ í™•ì¸
                const reportTemplates = searchEngine.getReportTemplates();
                if (reportTemplates && reportTemplates.length > 0) {
                    displayResult('search-results', true, `âœ… ë³´ê³ ì„œ í…œí”Œë¦¿ ë¡œë“œë¨ (${reportTemplates.length}ê°œ)`);
                    log(`ë³´ê³ ì„œ í…œí”Œë¦¿ ${reportTemplates.length}ê°œ í™•ì¸`);
                } else {
                    displayResult('search-results', false, 'âŒ ë³´ê³ ì„œ í…œí”Œë¦¿ ì—†ìŒ');
                    log('ë³´ê³ ì„œ í…œí”Œë¦¿ ì—†ìŒ', 'error');
                }

                // ê°„ë‹¨í•œ ë³´ê³ ì„œ ìƒì„± í…ŒìŠ¤íŠ¸
                try {
                    const report = await searchEngine.generateReport('inventory_status');
                    if (report && report.data) {
                        displayResult('search-results', true, 'âœ… ë³´ê³ ì„œ ìƒì„± ì„±ê³µ');
                        log('ë³´ê³ ì„œ ìƒì„± í…ŒìŠ¤íŠ¸ í†µê³¼');
                    } else {
                        displayResult('search-results', false, 'âŒ ë³´ê³ ì„œ ìƒì„± ì‹¤íŒ¨');
                        log('ë³´ê³ ì„œ ìƒì„± í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                    }
                } catch (reportError) {
                    displayResult('search-results', false, `âŒ ë³´ê³ ì„œ ìƒì„± ì˜¤ë¥˜: ${reportError.message}`);
                    log(`ë³´ê³ ì„œ ìƒì„± ì˜¤ë¥˜: ${reportError.message}`, 'error');
                }

            } catch (error) {
                displayResult('search-results', false, `âŒ ê²€ìƒ‰ ì—”ì§„ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
                log(`ê²€ìƒ‰ ì—”ì§„ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // í†µí•© API í…ŒìŠ¤íŠ¸
        async function testIntegratedAPI() {
            clearResults('api-results');
            log('í†µí•© API í…ŒìŠ¤íŠ¸ ì‹œì‘');

            try {
                const api = window.IntegratedAPI;

                // ì¹´í…Œê³ ë¦¬ API í…ŒìŠ¤íŠ¸
                const categories = await api.getCategories();
                displayResult('api-results', true, `âœ… ì¹´í…Œê³ ë¦¬ API í˜¸ì¶œ ì„±ê³µ (${categories.length}ê°œ)`);
                log(`ì¹´í…Œê³ ë¦¬ API í…ŒìŠ¤íŠ¸ í†µê³¼: ${categories.length}ê°œ`);

                // í’ˆëª© API í…ŒìŠ¤íŠ¸
                const items = await api.getItems();
                displayResult('api-results', true, `âœ… í’ˆëª© API í˜¸ì¶œ ì„±ê³µ (${items.length}ê°œ)`);
                log(`í’ˆëª© API í…ŒìŠ¤íŠ¸ í†µê³¼: ${items.length}ê°œ`);

                // ê±°ë˜ì²˜ API í…ŒìŠ¤íŠ¸
                const suppliers = await api.getSuppliers();
                displayResult('api-results', true, `âœ… ê±°ë˜ì²˜ API í˜¸ì¶œ ì„±ê³µ (${suppliers.length}ê°œ)`);
                log(`ê±°ë˜ì²˜ API í…ŒìŠ¤íŠ¸ í†µê³¼: ${suppliers.length}ê°œ`);

                // ëŒ€ì‹œë³´ë“œ í†µê³„ API í…ŒìŠ¤íŠ¸
                const stats = await api.getDashboardStats();
                if (stats && typeof stats === 'object') {
                    displayResult('api-results', true, 'âœ… ëŒ€ì‹œë³´ë“œ í†µê³„ API ì„±ê³µ');
                    log('ëŒ€ì‹œë³´ë“œ í†µê³„ API í…ŒìŠ¤íŠ¸ í†µê³¼');
                } else {
                    displayResult('api-results', false, 'âŒ ëŒ€ì‹œë³´ë“œ í†µê³„ API ì‹¤íŒ¨');
                    log('ëŒ€ì‹œë³´ë“œ í†µê³„ API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                }

                // ì•Œë¦¼ API í…ŒìŠ¤íŠ¸
                const notificationResult = await api.addNotification(
                    'test_notification',
                    'í…ŒìŠ¤íŠ¸ ì•Œë¦¼',
                    'í†µí•© API í…ŒìŠ¤íŠ¸ ì¤‘ì…ë‹ˆë‹¤.'
                );
                if (notificationResult && notificationResult.id) {
                    displayResult('api-results', true, 'âœ… ì•Œë¦¼ API ì„±ê³µ');
                    log('ì•Œë¦¼ API í…ŒìŠ¤íŠ¸ í†µê³¼');
                } else {
                    displayResult('api-results', false, 'âŒ ì•Œë¦¼ API ì‹¤íŒ¨');
                    log('ì•Œë¦¼ API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨', 'error');
                }

            } catch (error) {
                displayResult('api-results', false, `âŒ í†µí•© API í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
                log(`í†µí•© API í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸
        async function runFullIntegrationTest() {
            clearResults('full-results');
            clearLog();
            log('=== ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');

            try {
                // ëª¨ë“  í…ŒìŠ¤íŠ¸ ìˆœì°¨ ì‹¤í–‰
                await testSystemInitialization();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testDataManager();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testRealtimeSync();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testWorkflow();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testSearchEngine();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testIntegratedAPI();

                // ì¢…í•© ê²°ê³¼ ë¶„ì„
                const totalTests = testResults.length;
                const errorTests = testResults.filter(r => r.type === 'error').length;
                const successRate = ((totalTests - errorTests) / totalTests * 100).toFixed(1);

                if (errorTests === 0) {
                    displayResult('full-results', true, `ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼! (${totalTests}ê°œ í…ŒìŠ¤íŠ¸)`);
                    log(`ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ: ì„±ê³µë¥  ${successRate}%`);
                } else {
                    displayResult('full-results', false, `âš ï¸ ${errorTests}ê°œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ (ì„±ê³µë¥ : ${successRate}%)`);
                    log(`ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ: ${errorTests}ê°œ ì‹¤íŒ¨, ì„±ê³µë¥  ${successRate}%`, 'error');
                }

                // ì‹œìŠ¤í…œ ì„±ëŠ¥ ì¸¡ì •
                const performanceResults = measurePerformance();
                displayResult('full-results', true, `ğŸ“Š ì„±ëŠ¥ ì¸¡ì •: ${performanceResults}`);
                log(`ì„±ëŠ¥ ì¸¡ì • ê²°ê³¼: ${performanceResults}`);

                log('=== ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸ ì™„ë£Œ ===');

            } catch (error) {
                displayResult('full-results', false, `âŒ ì „ì²´ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
                log(`ì „ì²´ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        // ì„±ëŠ¥ ì¸¡ì •
        function measurePerformance() {
            const dataManager = window.IntegratedDataManager;
            const storageUsage = dataManager.getStorageUsage();
            
            return `ì €ì¥ê³µê°„: ${storageUsage.totalMB}MB, ë©”ëª¨ë¦¬: ${(performance.memory?.usedJSHeapSize / 1024 / 1024 || 0).toFixed(1)}MB`;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
        window.addEventListener('load', () => {
            log('í†µí•© ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            log('ê°œë³„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.');
        });
    </script>
</body>
</html>